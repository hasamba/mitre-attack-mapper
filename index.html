<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MITRE ATT&CK Technique Mapper</title>
    <meta name="description" content="Map textual attack descriptions to MITRE ATT&CK techniques instantly">
    <meta name="keywords" content="MITRE ATT&CK, cybersecurity, threat intelligence, DFIR, SOC">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,400;0,500;0,700;1,400&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-bg: #0a0a0a;
            --secondary-bg: #111111;
            --accent-bg: #1a1a1a;
            --terminal-green: #00ff41;
            --terminal-cyan: #00ffff;
            --terminal-orange: #ff6b00;
            --terminal-red: #ff0040;
            --terminal-yellow: #ffff00;
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0a0;
            --text-dim: #606060;
            --border-primary: #333333;
            --border-accent: #00ff41;
            --glow-green: rgba(0, 255, 65, 0.3);
            --glow-cyan: rgba(0, 255, 255, 0.3);
            --glow-orange: rgba(255, 107, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'JetBrains Mono', 'Consolas', 'Monaco', monospace;
            background: var(--primary-bg);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
        }

        /* Terminal scanline effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(0, 255, 65, 0.02) 2px,
                rgba(0, 255, 65, 0.02) 4px
            );
            pointer-events: none;
            z-index: 1000;
            animation: scanlines 0.1s linear infinite;
        }

        @keyframes scanlines {
            0% { transform: translateY(0); }
            100% { transform: translateY(4px); }
        }

        /* Matrix-style background */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(1px 1px at 20px 30px, rgba(0, 255, 65, 0.1), transparent),
                radial-gradient(1px 1px at 40px 70px, rgba(0, 255, 255, 0.05), transparent),
                radial-gradient(2px 2px at 90px 40px, rgba(255, 107, 0, 0.05), transparent);
            background-repeat: repeat;
            background-size: 200px 200px;
            animation: matrix-drift 20s linear infinite;
            pointer-events: none;
            z-index: -1;
        }

        @keyframes matrix-drift {
            0% { transform: translate(0, 0); }
            100% { transform: translate(-200px, -200px); }
        }

        .terminal-cursor {
            display: inline-block;
            width: 2px;
            height: 1.2em;
            background: var(--terminal-green);
            animation: blink 1s infinite;
            vertical-align: text-bottom;
            margin-left: 1px;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: grid;
            grid-template-rows: auto 1fr auto;
            gap: 20px;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            padding: 30px 0;
            border-bottom: 2px solid var(--border-primary);
            background: linear-gradient(135deg, var(--secondary-bg) 0%, var(--accent-bg) 100%);
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 
                0 0 20px rgba(0, 255, 65, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 65, 0.1), transparent);
            animation: sweep 3s infinite;
        }

        @keyframes sweep {
            0% { left: -100%; }
            50% { left: 100%; }
            100% { left: 100%; }
        }

        .header h1 {
            font-family: 'Orbitron', monospace;
            font-size: 3rem;
            font-weight: 900;
            color: var(--terminal-green);
            margin-bottom: 10px;
            text-shadow: 
                0 0 10px var(--glow-green),
                0 0 20px var(--glow-green),
                0 0 40px var(--glow-green);
            letter-spacing: 2px;
            animation: title-glow 3s ease-in-out infinite alternate;
        }

        @keyframes title-glow {
            0% { text-shadow: 0 0 10px var(--glow-green), 0 0 20px var(--glow-green), 0 0 40px var(--glow-green); }
            100% { text-shadow: 0 0 15px var(--glow-green), 0 0 30px var(--glow-green), 0 0 60px var(--glow-green); }
        }

        .header p {
            font-size: 1.1rem;
            color: var(--terminal-cyan);
            max-width: 600px;
            margin: 0 auto;
            text-shadow: 0 0 5px var(--glow-cyan);
            animation: type-in 2s ease-out;
        }

        @keyframes type-in {
            0% { width: 0; overflow: hidden; }
            100% { width: 100%; }
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--secondary-bg);
            padding: 10px 20px;
            border-radius: 4px;
            border: 1px solid var(--border-primary);
            font-size: 0.8rem;
            margin-bottom: 20px;
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--terminal-green);
            box-shadow: 0 0 10px var(--glow-green);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 450px;
            gap: 30px;
            align-items: start;
        }

        .terminal-window {
            background: var(--secondary-bg);
            border-radius: 8px;
            border: 2px solid var(--border-primary);
            box-shadow: 
                0 0 30px rgba(0, 0, 0, 0.7),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            overflow: hidden;
            position: relative;
        }

        .terminal-header {
            background: linear-gradient(135deg, #2a2a2a, #1a1a1a);
            padding: 10px 15px;
            border-bottom: 1px solid var(--border-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .terminal-controls {
            display: flex;
            gap: 5px;
        }

        .terminal-control {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            cursor: pointer;
        }

        .control-close { background: var(--terminal-red); }
        .control-minimize { background: var(--terminal-yellow); }
        .control-maximize { background: var(--terminal-green); }

        .terminal-title {
            color: var(--text-secondary);
            font-size: 0.8rem;
            font-weight: 500;
        }

        .input-section {
            padding: 25px;
        }

        .section-title {
            color: var(--terminal-cyan);
            margin-bottom: 15px;
            font-size: 1.2rem;
            font-weight: 700;
            text-shadow: 0 0 5px var(--glow-cyan);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title::before {
            content: '>';
            color: var(--terminal-green);
            font-weight: bold;
        }

        .textarea-container {
            position: relative;
            margin-bottom: 20px;
        }

        #attackDescription {
            width: 100%;
            min-height: 200px;
            background: var(--primary-bg);
            border: 2px solid var(--border-primary);
            border-radius: 6px;
            padding: 15px;
            color: var(--text-primary);
            font-size: 14px;
            line-height: 1.6;
            resize: vertical;
            font-family: 'JetBrains Mono', monospace;
            transition: all 0.3s ease;
        }

        #attackDescription:focus {
            outline: none;
            border-color: var(--terminal-green);
            box-shadow: 
                0 0 0 2px var(--glow-green),
                inset 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        #attackDescription::placeholder {
            color: var(--text-dim);
        }

        .char-counter {
            position: absolute;
            bottom: -20px;
            right: 0;
            font-size: 11px;
            color: var(--text-dim);
        }

        .controls {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(135deg, var(--terminal-green), #00cc33);
            color: var(--primary-bg);
            border: none;
            padding: 10px 18px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            font-size: 12px;
            font-family: 'JetBrains Mono', monospace;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            box-shadow: 
                0 0 15px var(--glow-green),
                0 2px 8px rgba(0, 0, 0, 0.4);
            transform: translateY(-1px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--terminal-cyan), #0099cc);
        }

        .btn-secondary:hover {
            box-shadow: 
                0 0 15px var(--glow-cyan),
                0 2px 8px rgba(0, 0, 0, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--terminal-orange), #cc5500);
        }

        .btn-danger:hover {
            box-shadow: 
                0 0 15px var(--glow-orange),
                0 2px 8px rgba(0, 0, 0, 0.4);
        }

        .results-section {
            padding: 25px;
        }

        .loading {
            text-align: center;
            padding: 40px 20px;
            color: var(--terminal-cyan);
        }

        .loading-spinner {
            display: inline-block;
            width: 30px;
            height: 30px;
            border: 3px solid var(--border-primary);
            border-top: 3px solid var(--terminal-cyan);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-family: 'Orbitron', monospace;
            font-size: 14px;
            letter-spacing: 1px;
        }

        .results {
            display: grid;
            gap: 15px;
            max-height: 600px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .results::-webkit-scrollbar {
            width: 8px;
        }

        .results::-webkit-scrollbar-track {
            background: var(--primary-bg);
            border-radius: 4px;
        }

        .results::-webkit-scrollbar-thumb {
            background: var(--terminal-green);
            border-radius: 4px;
            box-shadow: 0 0 5px var(--glow-green);
        }

        .technique-card {
            background: var(--primary-bg);
            border: 1px solid var(--border-primary);
            border-radius: 6px;
            padding: 16px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .technique-card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--terminal-green);
            transform: scaleY(0);
            transition: transform 0.3s ease;
            transform-origin: bottom;
        }

        .technique-card:hover {
            border-color: var(--terminal-green);
            box-shadow: 0 0 20px var(--glow-green);
            transform: translateX(5px);
        }

        .technique-card:hover::before {
            transform: scaleY(1);
        }

        .technique-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
            gap: 10px;
        }

        .technique-id {
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            color: var(--terminal-orange);
            font-size: 13px;
            text-shadow: 0 0 3px var(--glow-orange);
        }

        .confidence-badge {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background: var(--terminal-green);
            color: var(--primary-bg);
            box-shadow: 0 0 8px var(--glow-green);
        }

        .confidence-medium {
            background: var(--terminal-cyan);
            box-shadow: 0 0 8px var(--glow-cyan);
        }

        .confidence-low {
            background: var(--terminal-orange);
            box-shadow: 0 0 8px var(--glow-orange);
        }

        .technique-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
            font-size: 14px;
        }

        .technique-description {
            color: var(--text-secondary);
            font-size: 12px;
            line-height: 1.5;
            margin-bottom: 10px;
        }

        .matched-keywords {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .keyword {
            background: rgba(0, 255, 65, 0.2);
            color: var(--terminal-green);
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 10px;
            font-weight: 500;
            border: 1px solid var(--terminal-green);
        }

        .no-results {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-dim);
            font-style: italic;
        }

        .export-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-primary);
        }

        .stats-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: var(--accent-bg);
            padding: 12px;
            border-radius: 4px;
            text-align: center;
            border: 1px solid var(--border-primary);
        }

        .stat-value {
            font-family: 'Orbitron', monospace;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--terminal-green);
            text-shadow: 0 0 5px var(--glow-green);
            display: block;
        }

        .stat-label {
            font-size: 0.7rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .footer {
            text-align: center;
            padding: 20px 0;
            border-top: 1px solid var(--border-primary);
            color: var(--text-dim);
            font-size: 12px;
        }

        .footer a {
            color: var(--terminal-cyan);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer a:hover {
            color: var(--terminal-green);
            text-shadow: 0 0 3px var(--glow-green);
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .container {
                padding: 15px;
            }
        }

        .typewriter {
            overflow: hidden;
            border-right: 2px solid var(--terminal-green);
            white-space: nowrap;
            animation: 
                typing 3s steps(40, end),
                blink-caret 0.75s step-end infinite;
        }

        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }

        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: var(--terminal-green) }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>MITRE ATT&CK</h1>
            <h1 style="margin-top: -10px;">TECHNIQUE MAPPER</h1>
            <p>Advanced threat intelligence analysis terminal<span class="terminal-cursor"></span></p>
        </div>

        <div class="status-bar">
            <div class="status-item">
                <span class="status-indicator"></span>
                <span>SYSTEM ONLINE</span>
            </div>
            <div class="status-item">
                <span>TECHNIQUES: 30+</span>
            </div>
            <div class="status-item">
                <span>MODE: REAL-TIME</span>
            </div>
            <div class="status-item">
                <span id="current-time"></span>
            </div>
        </div>

        <div class="main-content">
            <div class="terminal-window">
                <div class="terminal-header">
                    <div class="terminal-controls">
                        <div class="terminal-control control-close"></div>
                        <div class="terminal-control control-minimize"></div>
                        <div class="terminal-control control-maximize"></div>
                    </div>
                    <div class="terminal-title">attack_analyzer.exe</div>
                </div>
                <div class="input-section">
                    <h2 class="section-title">INPUT STREAM</h2>
                    <div class="textarea-container">
                        <textarea 
                            id="attackDescription" 
                            placeholder="Enter attack description, IOCs, or threat intelligence data...
                            
Example: 'Adversary used PowerShell to download and execute malicious payload from external server, established persistence through registry modification, and performed lateral movement using WMI.'"
                            maxlength="5000"></textarea>
                        <div class="char-counter">
                            <span id="charCount">0</span>/5000
                        </div>
                    </div>
                    
                    <div class="controls">
                        <button class="btn" onclick="analyzeAttack()" id="analyzeBtn">
                            <span>üîç</span> ANALYZE
                        </button>
                        <button class="btn btn-secondary" onclick="loadExample()">
                            <span>üìã</span> LOAD EXAMPLE
                        </button>
                        <button class="btn btn-danger" onclick="clearInput()">
                            <span>üóëÔ∏è</span> CLEAR
                        </button>
                    </div>
                </div>
            </div>

            <div class="terminal-window">
                <div class="terminal-header">
                    <div class="terminal-controls">
                        <div class="terminal-control control-close"></div>
                        <div class="terminal-control control-minimize"></div>
                        <div class="terminal-control control-maximize"></div>
                    </div>
                    <div class="terminal-title">mitre_results.log</div>
                </div>
                <div class="results-section">
                    <h2 class="section-title">ANALYSIS RESULTS</h2>
                    
                    <div class="stats-display">
                        <div class="stat-card">
                            <span class="stat-value" id="matchCount">0</span>
                            <span class="stat-label">MATCHES</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-value" id="highConfidence">0</span>
                            <span class="stat-label">HIGH CONF</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-value" id="medConfidence">0</span>
                            <span class="stat-label">MED CONF</span>
                        </div>
                        <div class="stat-card">
                            <span class="stat-value" id="lowConfidence">0</span>
                            <span class="stat-label">LOW CONF</span>
                        </div>
                    </div>

                    <div id="results">
                        <div class="no-results">
                            <p>> AWAITING INPUT...</p>
                            <p style="font-size: 11px; margin-top: 10px;">Enter attack description above to begin analysis</p>
                        </div>
                    </div>

                    <div class="export-section" id="exportSection" style="display: none;">
                        <div class="controls">
                            <button class="btn btn-secondary" onclick="exportResults()">
                                <span>üì•</span> EXPORT JSON
                            </button>
                            <button class="btn btn-secondary" onclick="copyToClipboard()">
                                <span>üìã</span> COPY RESULTS
                            </button>
                            <button class="btn btn-secondary" onclick="printResults()">
                                <span>üñ®Ô∏è</span> PRINT REPORT
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>&copy; 2026 MITRE ATT&CK Technique Mapper | 
            <a href="https://github.com/hasamba/mitre-attack-mapper" target="_blank">Source Code</a> | 
            <a href="https://attack.mitre.org" target="_blank">MITRE ATT&CK Framework</a></p>
        </div>
    </div>

    <script>
        // Update time display
        function updateTime() {
            const now = new Date();
            document.getElementById('current-time').textContent = 
                now.toTimeString().substr(0, 8) + ' UTC';
        }
        setInterval(updateTime, 1000);
        updateTime();

        // Character counter
        document.getElementById('attackDescription').addEventListener('input', function() {
            const charCount = this.value.length;
            document.getElementById('charCount').textContent = charCount;
        });

        // MITRE ATT&CK techniques database with keywords
        const mitreDatabase = [
            {
                id: "T1059.001",
                name: "PowerShell",
                description: "Adversaries may abuse PowerShell commands and scripts for execution.",
                keywords: ["powershell", "ps1", "invoke", "iex", "downloadstring", "powershell.exe", "encoded command"]
            },
            {
                id: "T1055",
                name: "Process Injection",
                description: "Adversaries may inject code into processes in order to evade detection.",
                keywords: ["process injection", "dll injection", "code injection", "createremotethread", "setwindowshookex"]
            },
            {
                id: "T1003",
                name: "OS Credential Dumping",
                description: "Adversaries may attempt to dump credentials to obtain account login information.",
                keywords: ["mimikatz", "lsass", "credential dumping", "password dump", "sam database", "ntds.dit"]
            },
            {
                id: "T1105",
                name: "Ingress Tool Transfer",
                description: "Adversaries may transfer tools or other files from an external system.",
                keywords: ["download", "wget", "curl", "certutil", "bitsadmin", "file transfer", "payload download"]
            },
            {
                id: "T1547.001",
                name: "Registry Run Keys / Startup Folder",
                description: "Adversaries may achieve persistence by adding programs to startup folders or registry run keys.",
                keywords: ["registry", "run key", "startup", "persistence", "autorun", "hkey_current_user\\software\\microsoft\\windows\\currentversion\\run"]
            },
            {
                id: "T1021.002",
                name: "SMB/Windows Admin Shares",
                description: "Adversaries may use SMB to interact with file shares for lateral movement.",
                keywords: ["smb", "admin shares", "psexec", "lateral movement", "net use", "c$", "admin$"]
            },
            {
                id: "T1047",
                name: "Windows Management Instrumentation",
                description: "Adversaries may abuse WMI to execute malicious commands and payloads.",
                keywords: ["wmi", "wmic", "windows management instrumentation", "wmi query", "cim"]
            },
            {
                id: "T1543.003",
                name: "Windows Service",
                description: "Adversaries may create or modify Windows services to achieve persistence.",
                keywords: ["service", "sc.exe", "services.exe", "windows service", "service creation"]
            },
            {
                id: "T1087.002",
                name: "Domain Account Discovery",
                description: "Adversaries may attempt to get a listing of domain accounts.",
                keywords: ["domain users", "net user", "ldap", "active directory", "domain enumeration"]
            },
            {
                id: "T1083",
                name: "File and Directory Discovery",
                description: "Adversaries may enumerate files and directories to find specific information.",
                keywords: ["file discovery", "directory enumeration", "dir", "ls", "find", "file listing"]
            },
            {
                id: "T1070.004",
                name: "File Deletion",
                description: "Adversaries may delete files to hide indicators of compromise.",
                keywords: ["file deletion", "del", "rm", "delete", "sdelete", "evidence removal"]
            },
            {
                id: "T1036",
                name: "Masquerading",
                description: "Adversaries may attempt to manipulate features to make executable content appear legitimate.",
                keywords: ["masquerading", "fake extension", "legitimate process", "process hollowing", "name spoofing"]
            },
            {
                id: "T1218.011",
                name: "Rundll32",
                description: "Adversaries may abuse rundll32.exe to proxy execution of malicious code.",
                keywords: ["rundll32", "rundll32.exe", "dll execution", "proxy execution"]
            },
            {
                id: "T1027",
                name: "Obfuscated Files or Information",
                description: "Adversaries may attempt to make payloads difficult to analyze.",
                keywords: ["obfuscation", "encoded", "encrypted", "packed", "steganography", "base64"]
            },
            {
                id: "T1082",
                name: "System Information Discovery",
                description: "Adversaries may attempt to get detailed information about the operating system.",
                keywords: ["system info", "systeminfo", "environment variables", "system discovery", "hostname"]
            },
            {
                id: "T1090",
                name: "Proxy",
                description: "Adversaries may use a connection proxy to direct network traffic.",
                keywords: ["proxy", "socks", "traffic redirection", "network proxy", "tunneling"]
            },
            {
                id: "T1012",
                name: "Query Registry",
                description: "Adversaries may interact with the Windows Registry to gather information.",
                keywords: ["registry query", "reg query", "regedit", "registry enumeration"]
            },
            {
                id: "T1018",
                name: "Remote System Discovery",
                description: "Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier.",
                keywords: ["network discovery", "ping", "arp", "net view", "remote systems"]
            },
            {
                id: "T1049",
                name: "System Network Connections Discovery",
                description: "Adversaries may attempt to get listing of network connections to or from the compromised system.",
                keywords: ["netstat", "network connections", "established connections", "listening ports"]
            },
            {
                id: "T1057",
                name: "Process Discovery",
                description: "Adversaries may attempt to get information about running processes on a system.",
                keywords: ["process list", "tasklist", "ps", "running processes", "process enumeration"]
            },
            {
                id: "T1124",
                name: "System Time Discovery",
                description: "Adversaries may gather system time and/or time zone from a local or remote system.",
                keywords: ["time", "timezone", "date", "system time", "clock"]
            },
            {
                id: "T1033",
                name: "System Owner/User Discovery",
                description: "Adversaries may attempt to identify the primary user, currently logged in user, or set of users.",
                keywords: ["whoami", "current user", "username", "user discovery", "logged in users"]
            },
            {
                id: "T1016",
                name: "System Network Configuration Discovery",
                description: "Adversaries may look for details about the network configuration of systems.",
                keywords: ["ipconfig", "ifconfig", "network configuration", "dns", "routing table"]
            },
            {
                id: "T1204.002",
                name: "Malicious File",
                description: "Adversaries may rely upon a user opening a malicious file in order to gain execution.",
                keywords: ["malicious file", "user execution", "email attachment", "document", "macro"]
            },
            {
                id: "T1566.001",
                name: "Spearphishing Attachment",
                description: "Adversaries may send spearphishing emails with malicious attachments.",
                keywords: ["spearphishing", "email attachment", "phishing", "malicious email", "social engineering"]
            },
            {
                id: "T1071.001",
                name: "Web Protocols",
                description: "Adversaries may communicate using application layer protocols associated with web traffic.",
                keywords: ["http", "https", "web traffic", "application layer", "web protocols"]
            },
            {
                id: "T1041",
                name: "Exfiltration Over C2 Channel",
                description: "Adversaries may steal data by exfiltrating it over an existing command and control channel.",
                keywords: ["data exfiltration", "c2 channel", "command and control", "data theft", "exfiltration"]
            },
            {
                id: "T1112",
                name: "Modify Registry",
                description: "Adversaries may interact with the Windows Registry to hide configuration information.",
                keywords: ["modify registry", "registry modification", "reg add", "registry edit", "registry change"]
            },
            {
                id: "T1564.003",
                name: "Hidden Window",
                description: "Adversaries may use hidden windows to conceal malicious activity from the plain sight of users.",
                keywords: ["hidden window", "invisible window", "window hiding", "stealth execution"]
            },
            {
                id: "T1140",
                name: "Deobfuscate/Decode Files or Information",
                description: "Adversaries may use obfuscated files or information to hide artifacts of an intrusion.",
                keywords: ["decode", "deobfuscate", "decrypt", "unpack", "reveal", "decode payload"]
            }
        ];

        let currentResults = [];

        // Analyze attack description
        function analyzeAttack() {
            const description = document.getElementById('attackDescription').value.trim();
            
            if (!description) {
                alert('Please enter an attack description first.');
                return;
            }

            // Show loading state
            showLoading();
            
            // Simulate analysis delay for realistic feel
            setTimeout(() => {
                const results = performAnalysis(description);
                displayResults(results);
            }, 1500);
        }

        function showLoading() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">ANALYZING THREAT PATTERNS...</div>
                </div>
            `;
        }

        function performAnalysis(description) {
            const words = description.toLowerCase().split(/\\s+/);
            const results = [];

            mitreDatabase.forEach(technique => {
                const matchedKeywords = [];
                let totalScore = 0;

                technique.keywords.forEach(keyword => {
                    if (description.toLowerCase().includes(keyword.toLowerCase())) {
                        matchedKeywords.push(keyword);
                        totalScore += keyword.length; // Longer keywords get more weight
                    }
                });

                if (matchedKeywords.length > 0) {
                    // Calculate confidence based on number of matches and keyword length
                    const confidence = Math.min(100, (matchedKeywords.length * 20) + (totalScore * 2));
                    let confidenceLevel = 'low';
                    
                    if (confidence >= 70) confidenceLevel = 'high';
                    else if (confidence >= 40) confidenceLevel = 'medium';

                    results.push({
                        ...technique,
                        matchedKeywords,
                        confidence,
                        confidenceLevel
                    });
                }
            });

            // Sort by confidence score
            return results.sort((a, b) => b.confidence - a.confidence);
        }

        function displayResults(results) {
            currentResults = results;
            const resultsDiv = document.getElementById('results');
            const exportSection = document.getElementById('exportSection');
            
            // Update stats
            document.getElementById('matchCount').textContent = results.length;
            document.getElementById('highConfidence').textContent = 
                results.filter(r => r.confidenceLevel === 'high').length;
            document.getElementById('medConfidence').textContent = 
                results.filter(r => r.confidenceLevel === 'medium').length;
            document.getElementById('lowConfidence').textContent = 
                results.filter(r => r.confidenceLevel === 'low').length;

            if (results.length === 0) {
                resultsDiv.innerHTML = `
                    <div class="no-results">
                        <p>> NO MATCHES FOUND</p>
                        <p style="font-size: 11px; margin-top: 10px;">Try using different keywords or check spelling</p>
                    </div>
                `;
                exportSection.style.display = 'none';
            } else {
                resultsDiv.innerHTML = results.map(result => `
                    <div class="technique-card" onclick="selectTechnique('${result.id}')">
                        <div class="technique-header">
                            <span class="technique-id">${result.id}</span>
                            <span class="confidence-badge confidence-${result.confidenceLevel}">
                                ${result.confidence}% ${result.confidenceLevel.toUpperCase()}
                            </span>
                        </div>
                        <div class="technique-name">${result.name}</div>
                        <div class="technique-description">${result.description}</div>
                        <div class="matched-keywords">
                            ${result.matchedKeywords.map(keyword => 
                                `<span class="keyword">${keyword}</span>`
                            ).join('')}
                        </div>
                    </div>
                `).join('');
                exportSection.style.display = 'block';
            }
        }

        function selectTechnique(techniqueId) {
            const technique = currentResults.find(t => t.id === techniqueId);
            if (technique) {
                const url = `https://attack.mitre.org/techniques/${techniqueId.replace('.', '/')}/`;
                window.open(url, '_blank');
            }
        }

        function loadExample() {
            const examples = [
                "Adversary used PowerShell to download and execute malicious payload from external server, established persistence through registry modification, and performed lateral movement using WMI.",
                "Attacker sent spearphishing email with malicious Word document containing macro that downloaded additional payload via certutil, then used mimikatz to dump credentials from LSASS process.",
                "Malware achieved persistence by creating Windows service, performed process injection into legitimate system process, and exfiltrated data over HTTP channel.",
                "Threat actor used rundll32.exe to execute malicious DLL, performed system information discovery using systeminfo command, and established proxy for command and control communication."
            ];
            
            const randomExample = examples[Math.floor(Math.random() * examples.length)];
            document.getElementById('attackDescription').value = randomExample;
            document.getElementById('charCount').textContent = randomExample.length;
        }

        function clearInput() {
            document.getElementById('attackDescription').value = '';
            document.getElementById('charCount').textContent = '0';
            document.getElementById('results').innerHTML = `
                <div class="no-results">
                    <p>> AWAITING INPUT...</p>
                    <p style="font-size: 11px; margin-top: 10px;">Enter attack description above to begin analysis</p>
                </div>
            `;
            document.getElementById('exportSection').style.display = 'none';
            
            // Reset stats
            document.getElementById('matchCount').textContent = '0';
            document.getElementById('highConfidence').textContent = '0';
            document.getElementById('medConfidence').textContent = '0';
            document.getElementById('lowConfidence').textContent = '0';
        }

        function exportResults() {
            if (currentResults.length === 0) {
                alert('No results to export.');
                return;
            }

            const exportData = {
                timestamp: new Date().toISOString(),
                input: document.getElementById('attackDescription').value,
                results: currentResults.map(result => ({
                    technique_id: result.id,
                    technique_name: result.name,
                    description: result.description,
                    confidence: result.confidence,
                    confidence_level: result.confidenceLevel,
                    matched_keywords: result.matchedKeywords
                })),
                statistics: {
                    total_matches: currentResults.length,
                    high_confidence: currentResults.filter(r => r.confidenceLevel === 'high').length,
                    medium_confidence: currentResults.filter(r => r.confidenceLevel === 'medium').length,
                    low_confidence: currentResults.filter(r => r.confidenceLevel === 'low').length
                }
            };

            const blob = new Blob([JSON.stringify(exportData, null, 2)], { 
                type: 'application/json' 
            });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `mitre-analysis-${Date.now()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function copyToClipboard() {
            if (currentResults.length === 0) {
                alert('No results to copy.');
                return;
            }

            let text = `MITRE ATT&CK Analysis Results\\n`;
            text += `Generated: ${new Date().toISOString()}\\n`;
            text += `Total Matches: ${currentResults.length}\\n\\n`;

            currentResults.forEach(result => {
                text += `[${result.id}] ${result.name}\\n`;
                text += `Confidence: ${result.confidence}% (${result.confidenceLevel.toUpperCase()})\\n`;
                text += `Keywords: ${result.matchedKeywords.join(', ')}\\n`;
                text += `URL: https://attack.mitre.org/techniques/${result.id.replace('.', '/')}/\\n\\n`;
            });

            navigator.clipboard.writeText(text).then(() => {
                alert('Results copied to clipboard!');
            }).catch(() => {
                alert('Failed to copy to clipboard.');
            });
        }

        function printResults() {
            if (currentResults.length === 0) {
                alert('No results to print.');
                return;
            }
            window.print();
        }

        // Enter key support for analysis
        document.getElementById('attackDescription').addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                analyzeAttack();
            }
        });

        // Animate stats on load
        window.addEventListener('load', function() {
            const statValues = document.querySelectorAll('.stat-value');
            statValues.forEach((stat, index) => {
                setTimeout(() => {
                    stat.style.animation = 'pulse 0.5s ease-in-out';
                }, index * 100);
            });
        });
    </script>
</body>
</html>